# SolarSystemOrbitSimulator
Solar System Orbit Simulator (kepler 6 elements)
# 케플러 6요소를 통한 태양계 행성 공전 궤도 구현

 태양계 행성 위치를 시뮬레이션 하는 프로그램
 
탐구 동기
----
수학 보고서를 쓰던 중 케플러 법칙에 대해 자세히 알게 되었다. 그러다가 문득 행성의 궤도에 관한 법칙인 케플러 법칙을 보고 이 법칙을 이용하면 행성의 공전궤도를 알 수 있지 않을까 라는 생각에서 관련 자료를 찾고 실제로 구현해보기로 했다.

탐구 과정
----
처음에는 케플러의 행성운동법칙에 대해 자세히 찾아봤다. 하지만 이 법칙만으로는 공전 궤도를 예측하고 태양계 모델을 구현하는 것이 불가능해 보였다. 그래서 자료를 인터넷을 통해 더 찾아보니, 케플러 6요소라는 6가지 조건을 알면 행성의 공전궤도를 예측할 수 있다는 사실을 알게 되었다. 그래서 천구, 황도와 같은 용어를 이해하려고 노력했고, 관련 자료를 정리해둔 개인 블로그를 찾아 자료를 이해함으로써 케플러 6요소를 활용하여 구현하게 되었다.

케플러 6요소를 이해하기 위한 용어정리
----
 ![image](https://user-images.githubusercontent.com/26255336/113317663-8e591d80-934a-11eb-87e4-f3367cc90372.png)
- 천구의 적도   
치구의 적도면을 연장할 때 천구와 만나는 선을 천구의 적도라고한다.

- 천구의 황도   
 지구가 공전할 때 1년동안 태양이 천구상에 위치하는 곳을 선으로 이은 것이다. 천구의 적도와 황도는 약 23.5도 기울어져 있는데, 이는 지구의 자전축이 공전축에 대해 23.5도로 기울어져 있기 때문이다.   
![image](https://user-images.githubusercontent.com/26255336/113317786-b2b4fa00-934a-11eb-8846-b64ef3318173.png)
 
 - 적경   
 춘분점을 기준으로 천구의 적도를 따라 반시계 방향으로 측정된다. 단위는 시(h)이다.   
 ![image](https://user-images.githubusercontent.com/26255336/113317797-b5afea80-934a-11eb-97b9-5f8e19d8a1a3.png)

- 적위   
 천구의 적도를 0도로 북쪽을 +, 남쪽을 -로 0~90로 표기하는것이다.

- 황경, 황위   
 적경과 적위와 같은 개념이지만, 기준면이 황도면이다.

- 궤도 교점   
 천체의 궤도면과 기준면이 만나는 두 점을 의미한다. 궤도면과 기준면이 일치할 경우 궤도교점은 생기지 않는다.

- 궤도 교점   
 천체의 궤도면과 기준면이 만나는 두 점을 의미한다. 궤도면과 기준면이 일치할 경우 궤도교점은 생기지 않는다.   
 ![image](https://user-images.githubusercontent.com/26255336/113317805-b8124480-934a-11eb-8fa6-6611bd3af546.png)
 
- 승교점, 강교점   
 승교점은 궤도 교점중 기준면을 북쪽으로 지나가는 점을 의미하고, 강교점은 기준면을 남쪽으로 지나가는 점을 말한다.
 
 
케플러 6요소란?
----
케플러 6요소는 궤도의 모양, 크기, 방향을 결정할 때 알아야할 6개의 변수이다. 이 방법은 실제로 천문학과 궤도역학에 많이 쓰이는 방법이다. 하지만 궤도 요소들은 시간에 따라 변하기 떄문에 아무리 정확해도 근사치만 구할수 있다. 6가지 변수는 다음과 같다.   
 ![image](https://user-images.githubusercontent.com/26255336/113318365-5c948680-934b-11eb-94ca-098cc88f3a12.png)

- 장반경   
 행성의 궤도는 타원형이기 때문에 장반경과 단반경이 있다. 그중 궤도와 궤도 중심과의 거리가 가장 먼 지점을 장반경이라고 한다.
 
- 궤도 이심률   
 이심률은 얼마나 장반경과 단반경이 차이가 나는지에 대해 0~1로 나타낸 값이다. 0에 가까울수록 원에 가깝고, 1에 가까울수록 장반경과 단반경의 차이가 큰 타원이다. 궤도 이심률은 궤도의 이심률을 나타낸 값이다.

- 기울기   
 기준면에 대한 타원의 기울어진 정도를 말한다. 내가 참고한 자료는 황도면을 기준면으로 뒀다.


- 승교점 적경   
 행성의 황도면과 궤도가 남에서 북으로 지나며 교차하게 되는 지점의 적경을 의미한다.

- 근일점 편각   
 승교점으로부터 근일점 까지의 각도이다.

- 근일점 통과 시각   
 행성이 근일점을 통과하는 시각이다.


구현방법
----
 처음으로, 태양계 행성들의 궤도 요소 값들을 검색했다. 한 블로그에서 태양계 행성들의 궤도값을 찾을 수 있었고, 그 블로그에서 공개한 코드로 구현 방법도 알 수 있었다. 내가 사용한 궤도 요소값은 2가지 종류이다. J2000 에 측정한 궤도 요소 값과 한 세기당 궤도 요소 변화량 값을 각 행성마다 얻었다. 지구를 예를 들면 다음과 같다.   
|값|J2000때 측정된 값|한 세기당 궤도 요소 변화량|
|:---|:---:|:---:|
|장반경(a)|1.00000261AU|0.00000562AU|
|이심률(e)|0.01671123|-0.00004392|
|기울기(i)|-0.00001531|-0.01294668|
|승교점 적경(o)|0.0|0.0|
|평균 경도(l)|100.46457166|35999.37244981|
|근일점 경도(lp)|102.93768193|0.32327364|   
   
하지만 저 데이터에 위에서 언급한 6요소중 근일점 편각과 근일검 통과 시각이 없는걸 알 수 있다. 근일점 편각은 근일점 경도와 승교점 적경을 이용해 구하는 것이 가능하다. 근일점 통과 시각은 평균근점이각을 구할 때 필요한 값인데, 이 값은 근일점 경도와 평균 경도를 이용해 구하는 것이 가능하다. 그러므로 궤도를 예측하는데 필요한 데이터는 모두 갖춰졌다.

 
궤도 예측을 위해 가장 처음 할 일은 원하는 시각의 궤도 요소 값을 계산해서 수하는 일이다. 방법은 J2000때 측정된 값과 J2000으로부터 원하는 시각까지 지난 시간을 세기 단위로 환산해서 한 세기당 변화량에 곱한 값을 더하는 것이다. 식으로 표현하면 다음과 같다.
(J2000때 측정한 값)+ (한 세기당 궤도 요소 변화량)*(원하는 지점의 시각까지 지난 세기)
이렇게 구한 값중 근일점 경도(lp)와 승교점 적경(o)을 빼서 근일점 편각(w)을 구한다.   
w=lp-o   
    
 그 후, 평균근점이각(M)을 구한다. 평균근점이각이란 어떤 물체가 공전 속도와 주기를 유지한체 원 궤도로 옮겨 갔을 때 물체의 궤도위의 두 점 간의 각거리를 의미한다. 위 그림에서 회색원이 원래 궤도이고, 빨간색이 원으로 옮긴 궤도인 것이다. 타원은 초점과의 거리가 변하면 각속도도 변하기 때문에 구하기 쉬운 평균근점이각을 활용하는 것이다. 평균근점이각은 근일점 경도와 평균 경도의 차이다.
M=l-w   
    
이제 편심이각(E)을 구해야 한다. 편심이각이란 그림에서 각E에 해당한다. 점P를 현재 궤도에서의 물체의 위치, 점C는 타원의 중점, 점F는 타원의 초점이다. 이때 장반경과 같은 길이의 빗변 a를 중심C를 지나게 그리고, 선분 a의 끝점에서 P를 지나며 장반경에 수직하게 그려서 생긴 직각삼각형에서 관찰되는 각이다. 이 편심이각은 평균근점이각을 통해 유도 할 수 있다.   
E=(M+e sin⁡M)/(1-e cos⁡M )   
   
하지만 위 식은 근사치를 구하는 식이기 때문에 실제로 구현할 때는 뉴턴-랩슨법을 이용하여 20번 반복하여 정확도를 높였다.    
   
 이제 유클리드거리(r)과 진근점이각(v)만 구하면 된다. 장반경, 퍈심이각, 이심률을 이용해 실제 공전궤도의 위치를 (x,y)형태로 구한다.   
(x¦y)=((a×(cos⁡E-e))¦(a×√(1-e^2 )×sin⁡E ))   
   
 그 후, 태양을 (0,0)이라고 가정하고 (x,y)와의 거리를 구한다.   
r=√(x^2+y^2 )    
   
 마지막으로 탄젠트의 역수를 이용해 근일점으로부터의 각을 구한다.   
v=tan^(-1)⁡〖y/x〗   
   
 여기서 거리는 AU단위, 각은 라디안이다. 거리와 각이 있으면 실제 좌표 도출이 가능하다.   

참고 자료
----
https://evan-moon.github.io/2017/05/03/calculate-orbit-1/
https://evan-moon.github.io/2017/05/03/calculate-orbit-2/

https://ko.wikipedia.org/wiki/%EA%B6%A4%EB%8F%84_%EC%9A%94%EC%86%8C
https://ko.wikipedia.org/wiki/%EC%BC%80%ED%94%8C%EB%9F%AC%EC%9D%98_%ED%96%89%EC%84%B1%EC%9A%B4%EB%8F%99%EB%B2%95%EC%B9%99
https://ko.wikipedia.org/wiki/%ED%8F%89%EA%B7%A0_%EA%B7%BC%EC%A0%90_%EC%9D%B4%EA%B0%81

http://study.zum.com/book/14893
https://namu.wiki/w/%EB%89%B4%ED%84%B4-%EB%9E%A9%EC%8A%A8%20%EB%B0%A9%EB%B2%95
